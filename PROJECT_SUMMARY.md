# Сводка проекта: Blogger Stats Parser

## Описание

Автоматический парсер для сбора статистики роликов блогеров с YouTube, TikTok и Instagram в Google Sheets таблицу.

## Основные возможности

✅ Парсинг трех популярных платформ: YouTube, TikTok, Instagram
✅ Автоматическое добавление данных в Google Sheets
✅ Дедупликация (не добавляет один ролик дважды)
✅ Защита от повторного запуска в один день
✅ Подробное логирование всех операций
✅ Поддержка неограниченного количества блогеров
✅ Легкая настройка через JSON конфигурацию
✅ Автоматизация через Task Scheduler / Cron

## Собираемые данные

- Название ролика/поста
- Дата публикации
- Платформа
- URL ролика
- Просмотры
- Лайки
- Комментарии
- Репосты/Шеры
- Дата парсинга

## Архитектура

### Структура файлов

```
parcing/
├── main.py                 # Основной скрипт, точка входа
├── config.json             # Конфигурация блогеров
├── credentials.json        # Google API credentials (создается вручную)
├── processed_videos.json   # История обработанных роликов
├── requirements.txt        # Python зависимости
├── .gitignore             # Git ignore правила
├── LICENSE                # MIT License
│
├── parsers/               # Модули парсинга
│   ├── __init__.py
│   ├── youtube_parser.py   # YouTube парсер (requests + Selenium)
│   ├── tiktok_parser.py    # TikTok парсер (Selenium)
│   └── instagram_parser.py # Instagram парсер (Selenium)
│
├── utils/                 # Вспомогательные модули
│   ├── __init__.py
│   ├── logger.py          # Настройка логирования
│   └── sheets_manager.py  # Работа с Google Sheets API
│
├── logs/                  # Логи (создается автоматически)
│   └── parser_YYYYMMDD.log
│
└── docs/                  # Документация
    ├── README.md          # Основная документация
    ├── QUICKSTART.md      # Быстрый старт
    ├── SETUP.md           # Детальная установка
    ├── AUTOMATION.md      # Настройка автоматизации
    └── FAQ.md             # Частые вопросы
```

### Компоненты системы

#### 1. Парсеры (parsers/)

**YouTubeParser**
- Два режима: requests (быстро) и Selenium (надежно)
- Парсинг последнего видео с канала
- Извлечение: название, просмотры, лайки, URL

**TikTokParser**
- Использует Selenium (обязательно)
- Парсинг последнего видео с профиля
- Извлечение: описание, просмотры, лайки, комментарии, шеры

**InstagramParser**
- Использует Selenium (обязательно)
- Парсинг последнего поста с профиля
- Извлечение: описание, лайки, комментарии

#### 2. Утилиты (utils/)

**Logger**
- Настройка логирования в файл и консоль
- Ротация логов по дням
- Уровни: DEBUG (файл), INFO (консоль)

**SheetsManager**
- Подключение к Google Sheets через Service Account
- Добавление данных построчно
- Batch операции для множественного добавления
- Проверка дубликатов

#### 3. Основной скрипт (main.py)

**BloggerStatsCollector**
- Оркестрация всего процесса
- Загрузка конфигурации
- Управление парсерами
- Отслеживание обработанных роликов
- Сохранение в Google Sheets

## Технологии

### Backend
- **Python 3.8+** - основной язык
- **requests** - HTTP запросы
- **BeautifulSoup4** - парсинг HTML
- **Selenium** - автоматизация браузера
- **WebDriver Manager** - управление ChromeDriver

### API & Хранение
- **Google Sheets API** - хранение данных
- **gspread** - Python библиотека для Sheets
- **oauth2client** - аутентификация

### Дополнительные
- **tqdm** - прогресс-бар
- **python-dateutil** - работа с датами
- **lxml** - быстрый парсинг XML/HTML

## Рабочий процесс

```
┌──────────────┐
│   Запуск     │
│  main.py     │
└──────┬───────┘
       │
       ▼
┌──────────────────────┐
│ Загрузка config.json │
│ Список блогеров      │
└──────┬───────────────┘
       │
       ▼
┌─────────────────────────┐
│ Подключение к           │
│ Google Sheets           │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ Инициализация парсеров  │
│ (YouTube, TikTok, IG)   │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ ДЛЯ КАЖДОГО БЛОГЕРА:    │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ Парсинг YouTube         │
│ Проверка: обработан?    │
│ Если НЕТ → Добавить     │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ Парсинг TikTok          │
│ Проверка: обработан?    │
│ Если НЕТ → Добавить     │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ Парсинг Instagram       │
│ Проверка: обработан?    │
│ Если НЕТ → Добавить     │
└──────┬──────────────────┘
       │
       ▼
┌─────────────────────────┐
│ Сохранение в Sheets     │
│ Обновление processed.json│
└──────┬──────────────────┘
       │
       ▼
┌──────────────┐
│   Логи +     │
│  Статистика  │
└──────────────┘
```

## Особенности реализации

### Дедупликация
- Каждый ролик имеет уникальный URL
- URL сохраняется в `processed_videos.json` с датой обработки
- При повторном запуске проверяется: был ли ролик обработан сегодня
- Если да → пропускается, если нет → добавляется

### Обработка ошибок
- Try-catch блоки на каждом уровне
- Логирование всех ошибок
- Graceful degradation (если одна платформа не работает, остальные продолжают)
- Cleanup парсеров в finally блоке

### Rate Limiting
- Естественные задержки через Selenium
- Можно добавить time.sleep() между запросами
- Рекомендуется запускать не чаще 2-3 раз в день

## Ограничения

### YouTube
- API квота: 10,000 единиц/день (если используется API)
- Парсинг HTML: без ограничений, но медленнее

### TikTok
- Агрессивная защита от ботов
- Часто требуется Selenium + задержки
- Возможна блокировка IP

### Instagram
- Требует авторизации для многих данных
- Официальный API только для бизнес-аккаунтов
- Парсинг публичных данных не всегда работает

### Google Sheets
- Лимит: 10 млн ячеек на таблицу
- Лимит API запросов: 300/минута/пользователь

## Безопасность

- Service Account имеет минимальные права
- Доступ только к конкретной таблице
- credentials.json не должен публиковаться
- Добавлен в .gitignore

## Производительность

### Время выполнения
- YouTube (без Selenium): ~3-5 сек/блогер
- TikTok (Selenium): ~10-15 сек/блогер
- Instagram (Selenium): ~10-15 сек/блогер

### Для 10 блогеров
- Полный цикл: ~5-10 минут
- Только YouTube: ~1-2 минуты

### Оптимизация
- Отключить Selenium для YouTube где возможно
- Парсить только нужные платформы
- Использовать многопоточность (требует модификации)

## Расширяемость

### Добавление новой платформы
1. Создать новый парсер в `parsers/`
2. Наследоваться от базового класса или скопировать структуру
3. Реализовать метод `get_latest_video()`
4. Добавить в `main.py`

### Добавление новых метрик
1. Модифицировать парсер (добавить извлечение данных)
2. Обновить структуру в `sheets_manager.py` (добавить колонку)
3. Обновить mapping в `main.py`

### Добавление уведомлений
- Email (SMTP)
- Telegram (Bot API)
- Slack/Discord (Webhooks)

## Тестирование

- `test_parsers.py` - скрипт для проверки работоспособности
- Тестирует подключение к Google Sheets
- Тестирует каждый парсер на реальных данных
- Предоставляет рекомендации

## Документация

Полная документация включает:
- **README.md** (11KB) - основное описание
- **QUICKSTART.md** (3KB) - быстрый старт за 5 минут
- **SETUP.md** (11KB) - детальная установка
- **AUTOMATION.md** (12KB) - настройка автоматизации
- **FAQ.md** (16KB) - 50+ вопросов и ответов
- **PROJECT_SUMMARY.md** (этот файл) - техническая сводка

## Статистика проекта

- **Строк кода:** ~1,500
- **Файлов Python:** 8
- **Зависимостей:** 11
- **Поддерживаемых платформ:** 3
- **Языков документации:** Русский
- **Лицензия:** MIT

## Будущие улучшения

### Потенциальные фичи
- [ ] Web-интерфейс для управления
- [ ] Dashboard для визуализации статистики
- [ ] Поддержка Telegram, VK, Rutube
- [ ] Экспорт в CSV, Excel, JSON
- [ ] Telegram бот для управления
- [ ] Docker контейнер для легкого развертывания
- [ ] API для внешних приложений
- [ ] Машинное обучение для предсказания трендов
- [ ] Мультиязычность интерфейса
- [ ] Облачное развертывание (AWS, GCP, Azure)

### Технические улучшения
- [ ] Многопоточность / асинхронность
- [ ] Кэширование результатов
- [ ] Retry логика с exponential backoff
- [ ] Прокси-ротация
- [ ] Captcha solving
- [ ] Использование официальных API где возможно
- [ ] Unit и integration тесты
- [ ] CI/CD pipeline
- [ ] Мониторинг и алертинг
- [ ] Метрики производительности

## Вклад в проект

Проект создан с помощью Claude Code и может быть расширен сообществом.

Приветствуются:
- Улучшения парсеров
- Новые платформы
- Оптимизация производительности
- Исправление багов
- Улучшение документации

## Контакты и поддержка

- **Автор:** Claude Code (Anthropic)
- **Версия:** 1.0.0
- **Дата создания:** 2026-01-23
- **Лицензия:** MIT
- **GitHub:** (добавьте свой репозиторий)

---

**Создано с помощью Claude Code - AI-ассистента для разработки от Anthropic**
